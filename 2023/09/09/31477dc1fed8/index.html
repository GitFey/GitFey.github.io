<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>(UniAD)Planning-oriented Autonomous Driving | 罗辑往事</title><meta name="author" content="罗辑往事"><meta name="copyright" content="罗辑往事"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Planning-oriented Autonomous Driving上海AI实验室 &amp; 武汉大学 &amp; 商汤科技团队 (CVPR 2023最佳论文)  这是CVPR历史上第一篇以自动驾驶为主题的最佳论文。 也是近10年来计算机视觉三大顶级会议中（CVPR、ICCV、ECCV），第一篇以中国学术机构作为第一单位的最佳论文。 论文中，研究人员首次将感知、预测和规划等3大类主任务、6小">
<meta property="og:type" content="article">
<meta property="og:title" content="(UniAD)Planning-oriented Autonomous Driving">
<meta property="og:url" content="http://pfzone.top/2023/09/09/31477dc1fed8/index.html">
<meta property="og:site_name" content="罗辑往事">
<meta property="og:description" content="Planning-oriented Autonomous Driving上海AI实验室 &amp; 武汉大学 &amp; 商汤科技团队 (CVPR 2023最佳论文)  这是CVPR历史上第一篇以自动驾驶为主题的最佳论文。 也是近10年来计算机视觉三大顶级会议中（CVPR、ICCV、ECCV），第一篇以中国学术机构作为第一单位的最佳论文。 论文中，研究人员首次将感知、预测和规划等3大类主任务、6小">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://pfzone.top/img/posts/P-oAD/1.png">
<meta property="article:published_time" content="2023-09-09T01:00:00.000Z">
<meta property="article:modified_time" content="2023-09-09T15:09:58.704Z">
<meta property="article:author" content="罗辑往事">
<meta property="article:tag" content="轨迹预测">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://pfzone.top/img/posts/P-oAD/1.png"><link rel="shortcut icon" href="/img/christmasjuju.png"><link rel="canonical" href="http://pfzone.top/2023/09/09/31477dc1fed8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '(UniAD)Planning-oriented Autonomous Driving',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-09 23:09:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script src="https://cyan-blog.oss-cn-shenzhen.aliyuncs.com/cdn/js/three.min.js"></script><link rel="stylesheet" href="/css/myfont.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="centered"><div class="blob-1"></div><div class="blob-2"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
//监听页面加载完毕，因为页面加载速度太快，动画太短，禁用此项
window.addEventListener('load',()=> { preloader.endLoading() })  

//2秒自动关闭加载动画
setTimeout(function(){preloader.endLoading();}, 2000);

//鼠标点击事件关闭加载动画，狍狍等不及可以点一下
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()}) 



if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/christmasjuju.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/gallery"><span> 相册</span></a></div></div></div></div><div class="canvas-container" id="canvas"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/posts/P-oAD/1.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">罗辑往事</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/gallery"><span> 相册</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">(UniAD)Planning-oriented Autonomous Driving</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-09T01:00:00.000Z" title="发表于 2023-09-09 09:00:00">2023-09-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-09-09T15:09:58.704Z" title="更新于 2023-09-09 23:09:58">2023-09-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="(UniAD)Planning-oriented Autonomous Driving"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Planning-oriented-Autonomous-Driving"><a href="#Planning-oriented-Autonomous-Driving" class="headerlink" title="Planning-oriented Autonomous Driving"></a>Planning-oriented Autonomous Driving</h2><p>上海AI实验室 &amp; 武汉大学 &amp; 商汤科技团队</p>
<p>(CVPR 2023最佳论文)</p>
<p><img src="/./img/posts/P-oAD/1.png" alt="image-20230909150425114"></p>
<p>这是CVPR历史上第一篇以自动驾驶为主题的最佳论文。</p>
<p>也是近10年来计算机视觉三大顶级会议中（CVPR、ICCV、ECCV），第一篇以中国学术机构作为第一单位的最佳论文。</p>
<p>论文中，研究人员首次将<strong>感知</strong>、<strong>预测</strong>和<strong>规划</strong>等3大类主任务、6小类子任务（目标检测、目标跟踪、场景建图、轨迹预测、栅格预测和路径规划）整合到统一的基于Transformer的端到端网络框架下，<strong>实现了全栈关键任务驾驶通用模型，是自动驾驶中重要的技术突破。</strong></p>
<p>在nuScenes真实场景数据集下，UniAD的所有任务均刷新SOTA，尤其是预测和规划效果远超之前的最佳方案。</p>
<p>其中，多目标跟踪准确率超越SOTA 20%，车道线预测准确率提升30%，预测运动位移和规划的误差则分别降低了38%和28%。</p>
<p>UniAD的价值就在于，能更好地协助进行行车规划，实现「多任务」和「高性能」，确保车辆行驶的可靠和安全。</p>
<h2 id="Background-The-Design-Space-of-AD-Systems"><a href="#Background-The-Design-Space-of-AD-Systems" class="headerlink" title="Background - The Design Space of AD Systems"></a>Background - The Design Space of AD Systems</h2><p><img src="/./img/posts/P-oAD/20.png" alt="image-20230909151906911"></p>
<h3 id="Standalone-Models（a）"><a href="#Standalone-Models（a）" class="headerlink" title="Standalone Models（a）"></a>Standalone Models（a）</h3><p>每项任务独立部署独立的模型  ，典型的工业界的解决办法 ： 只要板载芯片的带宽允许，就会为每个任务独立部署各自的模型。 （Apollo 8.0）</p>
<ul>
<li><p>优点：Independent teams for module  developments 			</p>
</li>
<li><p>缺点： Severe error accumulation and  feature misalignment</p>
</li>
</ul>
<h3 id="Multi-task-Framework（b）"><a href="#Multi-task-Framework（b）" class="headerlink" title="Multi-task Framework（b）"></a>Multi-task Framework（b）</h3><p>针对多个任务的共享特征提取，这是很多领域的流行做法，包括通用视觉、自动驾驶，工业界的例子：Telsa</p>
<ul>
<li><p>优点： Easily extended to more tasks, and saving compute（非常容易扩充任务，并且由于特征共同提取，所以能节省算力）</p>
</li>
<li><p>缺点 ： Inefficient tasks’ coordination —-&gt; negative transfer （任务不相关性、任务权衡不当、特征冲突、训练不充分导致）</p>
</li>
</ul>
<h3 id="End-to-end-Framework-c"><a href="#End-to-end-Framework-c" class="headerlink" title="End-to-end Framework (c)"></a>End-to-end Framework (c)</h3><p>与前两种模式相比，端到端自动驾驶的出现将perception、prediction和planning的所有节点统一为一个整体。</p>
<p>为了支持planning任务，应确定选择哪些任务放在planning的前面，并确定各业务优先级。系统应以planning为导向，用一系列组件进行精细设计，以便于把各独立组件累积起来的误差或MTL方案中的负转移（negative transfer）减少到几乎没有。</p>
<p>表 1 描述了不同框架设计的任务分类。</p>
<p><img src="/./img/posts/P-oAD/4.png" alt="image-20230909164607909"></p>
<ol>
<li><strong>Vanilla Solutions（c.1）</strong></li>
</ol>
<p>   直接预测planning的轨迹，而没有任何显式的perception和prediction监督</p>
<ul>
<li><p>优点 ：Simple network design with good performance  in carla simulator(CARLA（Car Learning to Act）是一个用于自动驾驶系统开发和测试的开源模拟器。它是一个高度可定制的虚拟环境，旨在模拟城市驾驶场景，以帮助研究人员和开发人员验证和改进自动驾驶算法和系统。 )</p>
</li>
<li><p>缺点：Deficient in interpretability</p>
</li>
<li><p>思考：曾经有些开创性的工作在闭环仿真中验证了这种朴素的设计。虽然这个方向值得进一步探索，但它在安全保障和可解释性方面是不够的，特别是对于高动态的城市场景。</p>
</li>
<li><p>在本文中，作者倾向于另一个观点，并提出以下问题：面向可靠且以planning为导向的自动驾驶系统，如何设计有利于planning的工作流？在planning之前，哪些任务是必需的？  答 ： 一个直观的解决方案是感知周围的物体，预测它们在未来的行为并清晰地规划一个安全的操作，由此引入c.2</p>
</li>
</ul>
<ol start="2">
<li><strong>Explicit Design</strong>（<strong>c.2</strong>）</li>
</ol>
<p>   引入中间任务，以协助计划</p>
<ul>
<li>优点 ：Better interpretability</li>
<li>缺点 ： Some crucial components are missing </li>
<li>问题在于细节；之前的工作或多或少没有考虑某些组件(表1 c.2)）没有体现面向规划的精神。Contemporary end to end approach，任务或多或少都有缺失。作者在附录中说明了详细的定义和术语，以及这些模块的必要性 。</li>
</ul>
<h2 id="Motivation-Towards-Reliable-Planning"><a href="#Motivation-Towards-Reliable-Planning" class="headerlink" title="Motivation - Towards Reliable Planning"></a>Motivation - Towards Reliable Planning</h2><h3 id="Planning-oriented-Design-Ours"><a href="#Planning-oriented-Design-Ours" class="headerlink" title="Planning-oriented Design (Ours)"></a>Planning-oriented Design (Ours)</h3><p>这是一个统一的自动驾驶算法框架，利用五个基本任务来实现一个安全和强大的系统，如图1（c.3）和表1（c.3）所示。</p>
<p>UniAD的设计理念是面向planning。</p>
<p>作者认为，这不是针对一些简单任务利用工程实现来粗放地堆砌。</p>
<p>UniAD中的关键组件是基于query的设计来连接所有节点。</p>
<p>与传统的边界框表征形式相比，query受益于更大的感受野，可以减轻planning上游任务预测的复合误差。</p>
<p>此外，query可以灵活地对各种交互进行建模和编码，例如多个交通参与实体之间的关系。</p>
<p>作者提到，UniAD是第一个全面研究自动驾驶领域包括perception、prediction和planning在内的多种任务联合合作的作品。</p>
<p><img src="/./img/posts/P-oAD/3.png" alt="image-20230909163440026"></p>
<p>特点 ：</p>
<ul>
<li><strong>Jointly optimizing</strong> five essential AD tasks to facilitate planning </li>
<li><strong>Efficient tasks’ coordination</strong> with <strong>unified queries</strong> as interfaces </li>
<li>Diverse <strong>knowledge</strong> from upstream tasks is <strong>transmitted</strong> to planner</li>
</ul>
<h2 id="UniAD-How-to-Construct"><a href="#UniAD-How-to-Construct" class="headerlink" title="UniAD - How to Construct?"></a>UniAD - How to Construct?</h2><p><strong>核心问题：</strong>怎么使得信息能在各个模块中传递，并且与各个模块交互？</p>
<p>下图为UniAD的管道图 ，如图所示，UniAD包含四个基于transformer decoder的perception、prediction模块和一个planner。</p>
<p>Each tasks module is a <strong>transformer-based</strong> structure, with:</p>
<ul>
<li><strong>Attention</strong> mechanisms model complex relations in the scene</li>
<li><strong>Queries</strong> interact between tasks modules and transmit upstream knowledge to final planner.</li>
</ul>
<p><img src="/./img/posts/P-oAD/5.png" alt="image-20230909170143165"></p>
<p>具体来说，流程为  ：</p>
<ol>
<li><p>将一个多相机图像序列输入特征提取器，通过<code>BEVFormer</code>中的BEV编码器将特征提取器生成的透视视图特征转换为统一的鸟瞰图（BEV）特征B。</p>
</li>
<li><p>在 <code>TrackFormer</code> 中，采用叫做track queries的可学习embeddings从 B  中提取交通参与实体（agents）的信息，用来检测和追踪交通参与实体（agents）</p>
</li>
<li><p><code>MapFormer</code> 将map  queries作为道路元素（例如车道和分隔线）的语义抽象，并对地图实施全景分割。</p>
</li>
<li><p>通过上面介绍的这些表征交通参与实体（agents）和maps的queries，<code>MotionFormer</code> 捕获agents和maps之间的交互，并预测每个agent的未来轨迹。</p>
<p>由于每个agent的行为可以显著地影响场景中其它agents，因此MotionFormer模块对所有的agents进行联合预测。</p>
<p>同时，作者设计了一个自车query来显式地建模自车，并使其能够在这种以场景为中心的范式中与其它agents进行交互。</p>
</li>
<li><p><code>OccFormer</code> 使用 BEV 特征 B  作为query，用agents的知识作为key和value，并在保留agent特性的情况下预测多个步长的未来占用(future  occupancy)。</p>
</li>
<li><p>最后，<code>Planner</code>利用来自<code>MotionFormer</code> 的富有表现力的自车query来预测planning结果，并使自车远离 <code>OccFormer</code> 预测的占用区域(occupied regions)以避免碰撞。</p>
</li>
</ol>
<h2 id="Perception-TrackFormer-and-MapFormer"><a href="#Perception-TrackFormer-and-MapFormer" class="headerlink" title="Perception: TrackFormer and MapFormer"></a>Perception: TrackFormer and MapFormer</h2><h3 id="TrackFormer"><a href="#TrackFormer" class="headerlink" title="TrackFormer"></a>TrackFormer</h3><p>Modified from MOTR (ECCV 2022) : 论文地址 ： <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2105.03247.pdf">https://arxiv.org/pdf/2105.03247.pdf</a></p>
<p><img src="/./img/posts/P-oAD/6.png" alt="image-20230909171838877"></p>
<p>TrackFormer 包含 N 层，最终输出状态 <strong>Q</strong>A为下游预测任务提供了 <strong>N</strong>A 个有效agents的知识。</p>
<p>除了对环绕自车的其它agents进行query编码外，还在query集合中引入了一个特定的自车query，用来显式地建模自动驾驶汽车自身，该query将在后面用于planning。</p>
<h3 id="MapFormer"><a href="#MapFormer" class="headerlink" title="MapFormer"></a>MapFormer</h3><p>Modified from Panoptic SegFormer (CVPR 2022) ：论文地址 ： <a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content/CVPR2022/papers/Li_Panoptic_SegFormer_Delving_Deeper_Into_Panoptic_Segmentation_With_Transformers_CVPR_2022_paper.pdf">https://openaccess.thecvf.com/content/CVPR2022/papers/Li_Panoptic_SegFormer_Delving_Deeper_Into_Panoptic_Segmentation_With_Transformers_CVPR_2022_paper.pdf</a></p>
<p><img src="/./img/posts/P-oAD/7.png" alt="image-20230909172306003"></p>
<p>地图query集合分解为things query和stuff query。</p>
<p>things  query包含道路元素（即lanes、boundaries和pedestrian crossings），而 stuff  query仅负责语义元素（即可驾驶区域）。</p>
<p>文中将things query的总数设置为300，并且仅对可驾驶区域设置1个stuff  query。</p>
<p>最后通过经验选择位置解码器之后所得到的things query作为下游任务的map query  ，用于进行代理-地图互动。</p>
<h2 id="Prediction-MotionFormer-and-OccFormer"><a href="#Prediction-MotionFormer-and-OccFormer" class="headerlink" title="Prediction : MotionFormer and OccFormer"></a>Prediction : MotionFormer and OccFormer</h2><h3 id="MotionFormer"><a href="#MotionFormer" class="headerlink" title="MotionFormer"></a>MotionFormer</h3><p>捕捉交通参与者间的交互关系，并为每个交通参与者预测轨迹，对交通场景中的所有交通参与者进行联合的多模态轨迹预测。</p>
<p>作用是预测参与交通的实例物体运动轨迹。</p>
<p>采用scene-centric(场景为中心)范式，这种范式只需向前一次就可以在帧中生成多智能体轨迹，这大大节省了将整个场景与每个智能体的坐标对齐的计算成本.</p>
<p>输入为来自TrackFormer的<strong>Q</strong>A、来自MapFormer的 <strong>Q</strong>M 和密集的BEV特征<strong>B</strong>  ，并预测每个待预测主体在未来T个时间步长内的K条合理的预测轨迹.</p>
<p>同时对自车进行预测，作为未来规划的参考。</p>
<p>该部分的网络结构如下所示：它包括 N 层堆叠的</p>
<ol>
<li><p>agent-agent。车和车(人)之间的交互</p>
</li>
<li><p>agent-map。车和地图之间的交互</p>
</li>
<li><p>agent-goal。车和他们未来想要去的点之间的交互</p>
<p>agent-agent和agent-map交互模块使用标准transformer解码器层构建。</p>
</li>
</ol>
<p><img src="/./img/posts/P-oAD/8.png" alt="image-20230909203748036"></p>
<p>Qpos有四重左边含义 ：</p>
<ol>
<li>场景级锚点表示全局视角下的先前运动统计信息</li>
<li>代理级锚点捕捉了局部坐标系中的可能意图。它们都通过对真实轨迹的端点进行k-means聚类来缩小预测的不确定性。</li>
<li>起点为每个代理提供了定制的位置嵌入</li>
<li>预测的终点作为一个动态锚点以粗糙到精细的方式逐层优化。</li>
</ol>
<h3 id="OccFormer"><a href="#OccFormer" class="headerlink" title="OccFormer"></a>OccFormer</h3><p>占用栅格地图是一种离散化的BEV表示形式，其中每个单元格都包含一个表示其是否被占用的置信度</p>
<p>任务 : 发现未来栅格地图如何变化。是一个用于预测未来时间步长内场景中每个网格单元格是否被占据的模块。</p>
<p>之前的做法通过将BEV特征作为一个整体压缩到RNN隐藏状态，使得此过程与agent无关，这就导致由于agent知识的使用不足，这些方法很难预测全局所有agents的行为，然而这些信息对于了解场景如何演变却至关重要。</p>
<p>为了解决这个问题，作者提出了OccFormer，在两个方面合并了场景级和agent级的语义：</p>
<ol>
<li>密集场景特征通过一个设计精巧的自注意力模块在展开到未来视界时获取agent-level的特征</li>
<li>我们通过agent-level的特征和密集场景特征之间的矩阵乘法容易地生成instance-wise的占用，而不需要繁重的后处理。</li>
</ol>
<p><img src="/./img/posts/P-oAD/16.png" alt="image-20230909222334086"></p>
<p>做法：</p>
<ol>
<li><p>OccFormer由To个顺序块组成，其中To表示预测的时间范围。(由于密集表示的占用计算成本很高，To通常小于运动任务中的T)。</p>
</li>
<li><p>每个块的输入包括丰富的代理特征Gt和来自上一层的状态（密集特征）Ft−1，并且在考虑实例级和场景级信息的情况下生成时间步t的Ft。</p>
</li>
<li><p>为了获得具有动态和空间先验的代理特征Gt，我们从<code>MotionFormer</code>中取出多模态轨迹<code>QX</code> ，将其与上游的跟踪查询<code>QA</code>和当前位置嵌入<code>PA</code>通过一个时间特定的MLP进行融合：</p>
<p><img src="/./img/posts/P-oAD/17.png" alt="image-20230909222749312"></p>
</li>
<li><p>将上一帧场景级别的特征 （Ftds） 与 Gt 做注意力交互，得到本帧的场景特征:</p>
</li>
<li><p>最后与mask  相乘，得到instance-level 的occupancy。</p>
</li>
</ol>
<h2 id="Planning-Planner"><a href="#Planning-Planner" class="headerlink" title="Planning : Planner"></a>Planning : Planner</h2><p><img src="/./img/posts/P-oAD/13.png" alt="image-20230909213828376"></p>
<ul>
<li><strong>Collision optimization</strong>：Steer the predicted trajectories clear of occupied  areas to avoid potential collisions</li>
</ul>
<h2 id="Train"><a href="#Train" class="headerlink" title="Train"></a>Train</h2><p>UniAD 的训练分为两个阶段。</p>
<p>首先联合训练感知部分，即tracking和mapping模块，训练若干个epochs（在作者的实验中是 6  个），然后使用所有的perception、prediction和planning模块一起端到端地训练20个epochs。</p>
<p>从经验上来说，两个阶段的训练会更加稳定。</p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p><img src="/./img/posts/P-oAD/9.png" alt="image-20230909204527098"></p>
<ol>
<li><p>在实验4-6中探索了感知模块的贡献，加入tracking和mapping nodes使预测结果显着提高。</p>
</li>
<li><p>在实验7-9中，我们展示了两种预测（Motion ↔ Occupancy）的协同效应。当它们紧密集成时，两个任务的表现都得到了提高,，这证明了包含agents和场景表示的必要性。</p>
</li>
<li><p>在实验10-12中，只有当同时引入motion prediction 和 occ prediction这两个任务时（实验12），与没有任何中间任务的最简单的端到端plan相比，规划L2和碰撞率的指标均达到了最佳结果（实验10）。<strong>占用预测和轨迹预测任务都是实现安全plan目标所必需的。</strong></p>
<p><img src="/./img/posts/P-oAD/10.png" alt="image-20230909204809777"></p>
<p>规划结果甚至优于基于激光雷达的同行</p>
<p><img src="/./img/posts/P-oAD/15.png" alt="image-20230909215506267"></p>
</li>
</ol>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>本文讨论了自动驾驶算法框架的系统级设计。为了实现对规划的最终追求，提出了一个面向planning的pipeline，即UniAD。作者对感知和预测中每个模块的必要性进行了详细分析。为了统一任务，提出了一种基于query的设计来连接UniAD中的所有节点，从而在环境中受益于agent交互的更丰富的表征形式。大量的实验在各个方面验证了所提方法的有效性。</p>
<p>协调这样一个具有多个任务的综合系统并非易事，需要巨量的计算力，尤其还要使用时域上的历史信息进行训练。如何设计和策划轻量级部署的系统值得将来探索。此外，是否合并更多的任务，如深度估计、行为预测，以及如何将它们嵌入到系统中，也是值得未来探索的方向。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://pfzone.top">罗辑往事</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://pfzone.top/2023/09/09/31477dc1fed8/">http://pfzone.top/2023/09/09/31477dc1fed8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://pfzone.top" target="_blank">罗辑往事</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BD%A8%E8%BF%B9%E9%A2%84%E6%B5%8B/">轨迹预测</a></div><div class="post_share"><div class="social-share" data-image="/img/posts/P-oAD/1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/09/08/e82ab0d3a676/"><img class="next-cover" src="/img/cover/zte.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ZTE面经汇总</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/04/06/bd33735bca85/" title="轨迹预测之实验设置"><img class="cover" src="/img/cover/exp.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-06</div><div class="title">轨迹预测之实验设置</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/christmasjuju.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">罗辑往事</div><div class="author-info__description">没有人能找到这里，除了你</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/GitFey/GitFey.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎狍狍来访 ！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Planning-oriented-Autonomous-Driving"><span class="toc-number">1.</span> <span class="toc-text">Planning-oriented Autonomous Driving</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Background-The-Design-Space-of-AD-Systems"><span class="toc-number">2.</span> <span class="toc-text">Background - The Design Space of AD Systems</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Standalone-Models%EF%BC%88a%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">Standalone Models（a）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Multi-task-Framework%EF%BC%88b%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">Multi-task Framework（b）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#End-to-end-Framework-c"><span class="toc-number">2.3.</span> <span class="toc-text">End-to-end Framework (c)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Motivation-Towards-Reliable-Planning"><span class="toc-number">3.</span> <span class="toc-text">Motivation - Towards Reliable Planning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Planning-oriented-Design-Ours"><span class="toc-number">3.1.</span> <span class="toc-text">Planning-oriented Design (Ours)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UniAD-How-to-Construct"><span class="toc-number">4.</span> <span class="toc-text">UniAD - How to Construct?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Perception-TrackFormer-and-MapFormer"><span class="toc-number">5.</span> <span class="toc-text">Perception: TrackFormer and MapFormer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TrackFormer"><span class="toc-number">5.1.</span> <span class="toc-text">TrackFormer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MapFormer"><span class="toc-number">5.2.</span> <span class="toc-text">MapFormer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prediction-MotionFormer-and-OccFormer"><span class="toc-number">6.</span> <span class="toc-text">Prediction : MotionFormer and OccFormer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MotionFormer"><span class="toc-number">6.1.</span> <span class="toc-text">MotionFormer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OccFormer"><span class="toc-number">6.2.</span> <span class="toc-text">OccFormer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Planning-Planner"><span class="toc-number">7.</span> <span class="toc-text">Planning : Planner</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Train"><span class="toc-number">8.</span> <span class="toc-text">Train</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Results"><span class="toc-number">9.</span> <span class="toc-text">Results</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">10.</span> <span class="toc-text">Conclusion</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 罗辑往事</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/js/sky.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>